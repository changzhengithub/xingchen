<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序常见问题 | 星辰</title>
    <meta name="generator" content="VuePress 1.5.4">
    <link rel="icon" href="/xingchen/logo.ico">
    <meta name="description" content="我的个人博客，记录点滴">
    <link rel="preload" href="/xingchen/assets/css/0.styles.f612ea4d.css" as="style"><link rel="preload" href="/xingchen/assets/js/app.449d8865.js" as="script"><link rel="preload" href="/xingchen/assets/js/2.8855fdcf.js" as="script"><link rel="preload" href="/xingchen/assets/js/72.4abbeb3a.js" as="script"><link rel="prefetch" href="/xingchen/assets/js/10.b3cd0e05.js"><link rel="prefetch" href="/xingchen/assets/js/100.3741cb87.js"><link rel="prefetch" href="/xingchen/assets/js/101.6184018c.js"><link rel="prefetch" href="/xingchen/assets/js/102.14bb6b74.js"><link rel="prefetch" href="/xingchen/assets/js/103.0c6bdc99.js"><link rel="prefetch" href="/xingchen/assets/js/104.4746a397.js"><link rel="prefetch" href="/xingchen/assets/js/105.7479ddb9.js"><link rel="prefetch" href="/xingchen/assets/js/106.98aa2aa6.js"><link rel="prefetch" href="/xingchen/assets/js/107.c2bccbbe.js"><link rel="prefetch" href="/xingchen/assets/js/108.f21cc836.js"><link rel="prefetch" href="/xingchen/assets/js/109.1687f56d.js"><link rel="prefetch" href="/xingchen/assets/js/11.2f5782c7.js"><link rel="prefetch" href="/xingchen/assets/js/110.a82195df.js"><link rel="prefetch" href="/xingchen/assets/js/111.335ae45d.js"><link rel="prefetch" href="/xingchen/assets/js/112.e167e5fa.js"><link rel="prefetch" href="/xingchen/assets/js/113.ddd2a386.js"><link rel="prefetch" href="/xingchen/assets/js/114.7507f5fd.js"><link rel="prefetch" href="/xingchen/assets/js/115.de39161e.js"><link rel="prefetch" href="/xingchen/assets/js/116.b5d8d732.js"><link rel="prefetch" href="/xingchen/assets/js/117.1e4eec1d.js"><link rel="prefetch" href="/xingchen/assets/js/118.902db092.js"><link rel="prefetch" href="/xingchen/assets/js/119.179aba83.js"><link rel="prefetch" href="/xingchen/assets/js/12.97522e61.js"><link rel="prefetch" href="/xingchen/assets/js/120.907d0297.js"><link rel="prefetch" href="/xingchen/assets/js/121.99f14263.js"><link rel="prefetch" href="/xingchen/assets/js/122.cc1f89a0.js"><link rel="prefetch" href="/xingchen/assets/js/123.bde28301.js"><link rel="prefetch" href="/xingchen/assets/js/124.c34f5c9b.js"><link rel="prefetch" href="/xingchen/assets/js/125.ac8d24bd.js"><link rel="prefetch" href="/xingchen/assets/js/126.e623cfae.js"><link rel="prefetch" href="/xingchen/assets/js/127.6d11459b.js"><link rel="prefetch" href="/xingchen/assets/js/128.6497a86d.js"><link rel="prefetch" href="/xingchen/assets/js/129.226db5ee.js"><link rel="prefetch" href="/xingchen/assets/js/13.da1a3f07.js"><link rel="prefetch" href="/xingchen/assets/js/130.b5942383.js"><link rel="prefetch" href="/xingchen/assets/js/131.6210e5d7.js"><link rel="prefetch" href="/xingchen/assets/js/132.2f58b017.js"><link rel="prefetch" href="/xingchen/assets/js/133.a181a359.js"><link rel="prefetch" href="/xingchen/assets/js/14.fe4a33bb.js"><link rel="prefetch" href="/xingchen/assets/js/15.21d4eaca.js"><link rel="prefetch" href="/xingchen/assets/js/16.c853a137.js"><link rel="prefetch" href="/xingchen/assets/js/17.61b0cfbc.js"><link rel="prefetch" href="/xingchen/assets/js/18.aa314438.js"><link rel="prefetch" href="/xingchen/assets/js/19.02f62302.js"><link rel="prefetch" href="/xingchen/assets/js/20.23447ef3.js"><link rel="prefetch" href="/xingchen/assets/js/21.6dc9d8aa.js"><link rel="prefetch" href="/xingchen/assets/js/22.9ed9c6b6.js"><link rel="prefetch" href="/xingchen/assets/js/23.aee134c7.js"><link rel="prefetch" href="/xingchen/assets/js/24.5f61fcba.js"><link rel="prefetch" href="/xingchen/assets/js/25.62a742ce.js"><link rel="prefetch" href="/xingchen/assets/js/26.50ba4ab0.js"><link rel="prefetch" href="/xingchen/assets/js/27.ee91407e.js"><link rel="prefetch" href="/xingchen/assets/js/28.f8a736c7.js"><link rel="prefetch" href="/xingchen/assets/js/29.644e5cfa.js"><link rel="prefetch" href="/xingchen/assets/js/3.1555e676.js"><link rel="prefetch" href="/xingchen/assets/js/30.20572658.js"><link rel="prefetch" href="/xingchen/assets/js/31.4a21df99.js"><link rel="prefetch" href="/xingchen/assets/js/32.4290759a.js"><link rel="prefetch" href="/xingchen/assets/js/33.ed107e36.js"><link rel="prefetch" href="/xingchen/assets/js/34.454a6db9.js"><link rel="prefetch" href="/xingchen/assets/js/35.d58a959c.js"><link rel="prefetch" href="/xingchen/assets/js/36.a5242abf.js"><link rel="prefetch" href="/xingchen/assets/js/37.34c31688.js"><link rel="prefetch" href="/xingchen/assets/js/38.06c23d26.js"><link rel="prefetch" href="/xingchen/assets/js/39.1b167583.js"><link rel="prefetch" href="/xingchen/assets/js/4.79e3ce3d.js"><link rel="prefetch" href="/xingchen/assets/js/40.44f8b6c1.js"><link rel="prefetch" href="/xingchen/assets/js/41.36198171.js"><link rel="prefetch" href="/xingchen/assets/js/42.f62d7e38.js"><link rel="prefetch" href="/xingchen/assets/js/43.7302ee5b.js"><link rel="prefetch" href="/xingchen/assets/js/44.58849855.js"><link rel="prefetch" href="/xingchen/assets/js/45.16042e59.js"><link rel="prefetch" href="/xingchen/assets/js/46.4b531a07.js"><link rel="prefetch" href="/xingchen/assets/js/47.5731f90a.js"><link rel="prefetch" href="/xingchen/assets/js/48.cc52bb32.js"><link rel="prefetch" href="/xingchen/assets/js/49.086fa434.js"><link rel="prefetch" href="/xingchen/assets/js/5.e376ddbc.js"><link rel="prefetch" href="/xingchen/assets/js/50.f1e432ed.js"><link rel="prefetch" href="/xingchen/assets/js/51.054e8894.js"><link rel="prefetch" href="/xingchen/assets/js/52.73243566.js"><link rel="prefetch" href="/xingchen/assets/js/53.ec587e14.js"><link rel="prefetch" href="/xingchen/assets/js/54.9d13b841.js"><link rel="prefetch" href="/xingchen/assets/js/55.e8a45a0d.js"><link rel="prefetch" href="/xingchen/assets/js/56.e8c41e5a.js"><link rel="prefetch" href="/xingchen/assets/js/57.3d587386.js"><link rel="prefetch" href="/xingchen/assets/js/58.3c0431c0.js"><link rel="prefetch" href="/xingchen/assets/js/59.fbbe3a3c.js"><link rel="prefetch" href="/xingchen/assets/js/6.2acbb0fe.js"><link rel="prefetch" href="/xingchen/assets/js/60.913bd050.js"><link rel="prefetch" href="/xingchen/assets/js/61.4451b098.js"><link rel="prefetch" href="/xingchen/assets/js/62.9c21f238.js"><link rel="prefetch" href="/xingchen/assets/js/63.d595348f.js"><link rel="prefetch" href="/xingchen/assets/js/64.40d7f182.js"><link rel="prefetch" href="/xingchen/assets/js/65.aca69de2.js"><link rel="prefetch" href="/xingchen/assets/js/66.2f47dc61.js"><link rel="prefetch" href="/xingchen/assets/js/67.5bb32134.js"><link rel="prefetch" href="/xingchen/assets/js/68.dc746544.js"><link rel="prefetch" href="/xingchen/assets/js/69.ec6e378a.js"><link rel="prefetch" href="/xingchen/assets/js/7.ad96cf3d.js"><link rel="prefetch" href="/xingchen/assets/js/70.1487e5a4.js"><link rel="prefetch" href="/xingchen/assets/js/71.54f10fae.js"><link rel="prefetch" href="/xingchen/assets/js/73.412453cd.js"><link rel="prefetch" href="/xingchen/assets/js/74.d59e54c8.js"><link rel="prefetch" href="/xingchen/assets/js/75.95aa15cd.js"><link rel="prefetch" href="/xingchen/assets/js/76.6bc08d1b.js"><link rel="prefetch" href="/xingchen/assets/js/77.e5a81fab.js"><link rel="prefetch" href="/xingchen/assets/js/78.e4f8a0f4.js"><link rel="prefetch" href="/xingchen/assets/js/79.c86f7809.js"><link rel="prefetch" href="/xingchen/assets/js/8.356c890e.js"><link rel="prefetch" href="/xingchen/assets/js/80.c29cb623.js"><link rel="prefetch" href="/xingchen/assets/js/81.d9e7557b.js"><link rel="prefetch" href="/xingchen/assets/js/82.e8b75549.js"><link rel="prefetch" href="/xingchen/assets/js/83.ab193500.js"><link rel="prefetch" href="/xingchen/assets/js/84.0f2efcc1.js"><link rel="prefetch" href="/xingchen/assets/js/85.777a5ec7.js"><link rel="prefetch" href="/xingchen/assets/js/86.6ca64de5.js"><link rel="prefetch" href="/xingchen/assets/js/87.6c534565.js"><link rel="prefetch" href="/xingchen/assets/js/88.bf00aea8.js"><link rel="prefetch" href="/xingchen/assets/js/89.bd555073.js"><link rel="prefetch" href="/xingchen/assets/js/9.b12d7370.js"><link rel="prefetch" href="/xingchen/assets/js/90.3b28725f.js"><link rel="prefetch" href="/xingchen/assets/js/91.acfcb3ea.js"><link rel="prefetch" href="/xingchen/assets/js/92.abb2a987.js"><link rel="prefetch" href="/xingchen/assets/js/93.d98f43b1.js"><link rel="prefetch" href="/xingchen/assets/js/94.6857c864.js"><link rel="prefetch" href="/xingchen/assets/js/95.de0d7fbb.js"><link rel="prefetch" href="/xingchen/assets/js/96.1dea2317.js"><link rel="prefetch" href="/xingchen/assets/js/97.4a47703b.js"><link rel="prefetch" href="/xingchen/assets/js/98.ab44542d.js"><link rel="prefetch" href="/xingchen/assets/js/99.0a58f911.js">
    <link rel="stylesheet" href="/xingchen/assets/css/0.styles.f612ea4d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/xingchen/" class="home-link router-link-active"><!----> <span class="site-name">星辰</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xingchen/basic/css/字体设置.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/xingchen/basic/javascript/基础问题.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/xingchen/basic/es6/基础内容.html" class="nav-link">
  ES6
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue" class="mobile-dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xingchen/vue/vue3/基础内容.html" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/xingchen/vue/vue2/基础内容.html" class="nav-link">
  Vue2
</a></li><li class="dropdown-item"><!----> <a href="/xingchen/vue/router/vue路由.html" class="nav-link">
  Router
</a></li></ul></div></div><div class="nav-item"><a href="/xingchen/typescript/" class="nav-link">
  TS
</a></div><div class="nav-item"><a href="/xingchen/canvas/" class="nav-link">
  Canvas
</a></div><div class="nav-item"><a href="/xingchen/videos/" class="nav-link">
  Video
</a></div><div class="nav-item"><a href="/xingchen/git/" class="nav-link">
  Git
</a></div><div class="nav-item"><a href="/xingchen/mobile/" class="nav-link router-link-active">
  移动端
</a></div><div class="nav-item"><a href="/xingchen/guide/" class="nav-link">
  开发规范
</a></div><div class="nav-item"><a href="/xingchen/synthesize/" class="nav-link">
  其他分类
</a></div><div class="nav-item"><a href="https://github.com/changzhengithub/xingchen" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端基础" class="dropdown-title"><span class="title">前端基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端基础" class="mobile-dropdown-title"><span class="title">前端基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xingchen/basic/css/字体设置.html" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/xingchen/basic/javascript/基础问题.html" class="nav-link">
  JS
</a></li><li class="dropdown-item"><!----> <a href="/xingchen/basic/es6/基础内容.html" class="nav-link">
  ES6
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Vue" class="dropdown-title"><span class="title">Vue</span> <span class="arrow down"></span></button> <button type="button" aria-label="Vue" class="mobile-dropdown-title"><span class="title">Vue</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/xingchen/vue/vue3/基础内容.html" class="nav-link">
  Vue3
</a></li><li class="dropdown-item"><!----> <a href="/xingchen/vue/vue2/基础内容.html" class="nav-link">
  Vue2
</a></li><li class="dropdown-item"><!----> <a href="/xingchen/vue/router/vue路由.html" class="nav-link">
  Router
</a></li></ul></div></div><div class="nav-item"><a href="/xingchen/typescript/" class="nav-link">
  TS
</a></div><div class="nav-item"><a href="/xingchen/canvas/" class="nav-link">
  Canvas
</a></div><div class="nav-item"><a href="/xingchen/videos/" class="nav-link">
  Video
</a></div><div class="nav-item"><a href="/xingchen/git/" class="nav-link">
  Git
</a></div><div class="nav-item"><a href="/xingchen/mobile/" class="nav-link router-link-active">
  移动端
</a></div><div class="nav-item"><a href="/xingchen/guide/" class="nav-link">
  开发规范
</a></div><div class="nav-item"><a href="/xingchen/synthesize/" class="nav-link">
  其他分类
</a></div><div class="nav-item"><a href="https://github.com/changzhengithub/xingchen" target="_blank" rel="noopener noreferrer" class="nav-link external">
  GitHub
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>小程序</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/xingchen/mobile/applet/小程序项目搭建.html" class="sidebar-link">项目构建</a></li><li><a href="/xingchen/mobile/applet/微信开发者工具使用插件.html" class="sidebar-link">微信开发者工具使用插件</a></li><li><a href="/xingchen/mobile/applet/小程序常见问题.html" class="active sidebar-link">小程序常见问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_1、用户登录" class="sidebar-link">1、用户登录</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_2、data数据修改" class="sidebar-link">2、data数据修改</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_3、函数绑定参数" class="sidebar-link">3、函数绑定参数</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_4、页面跳转" class="sidebar-link">4、页面跳转</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_5、双层for循环渲染" class="sidebar-link">5、双层for循环渲染</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_6、globaldata对象的获取" class="sidebar-link">6、globalData对象的获取</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_7、动态设置标题" class="sidebar-link">7、动态设置标题</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_8、页面周期函数与组件周期函数" class="sidebar-link">8、页面周期函数与组件周期函数</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_9、下拉刷新与滑动加载更多" class="sidebar-link">9、下拉刷新与滑动加载更多</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_10、获取当前页面路由信息" class="sidebar-link">10、获取当前页面路由信息</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_11、背景图片使用问题" class="sidebar-link">11、背景图片使用问题</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_12、获取微信授权信息" class="sidebar-link">12、获取微信授权信息</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_13、公众号链接跳转到详情页" class="sidebar-link">13、公众号链接跳转到详情页</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_14、图片上传" class="sidebar-link">14、图片上传</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_15、项目分包减少体积" class="sidebar-link">15、项目分包减少体积</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_16、版本更新提升" class="sidebar-link">16、版本更新提升</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_17、线上调试" class="sidebar-link">17、线上调试</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_18、自定义tabbar" class="sidebar-link">18、自定义tabbar</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_19、修改checkbox默认样式" class="sidebar-link">19、修改checkbox默认样式</a></li><li class="sidebar-sub-header"><a href="/xingchen/mobile/applet/小程序常见问题.html#_20、自定义标题-获取顶部高度" class="sidebar-link">20、自定义标题&amp;获取顶部高度</a></li></ul></li><li><a href="/xingchen/mobile/applet/自定义组件.html" class="sidebar-link">自定义组件</a></li><li><a href="/xingchen/mobile/applet/自定义tabbar.html" class="sidebar-link">自定义tabbar</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>H5</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="小程序常见问题"><a href="#小程序常见问题" class="header-anchor">#</a> 小程序常见问题</h1> <h2 id="_1、用户登录"><a href="#_1、用户登录" class="header-anchor">#</a> 1、用户登录</h2> <p>小程序有自己的登录方法 wx.login()，可以用来获取微信用户的信息，做一下简单的处理，但只有这是不够的，我们需要配合后台实现自己的登录，用来做鉴权验证。</p> <p>实现自己的登录流程大概分为下面几步：</p> <ol><li>调用wx.login()方法获取微信登录凭证（code）</li> <li>通过wx.getUserInfo()方法获取加密数据和加密算法</li> <li>把获取的code和加密数据、加密算法通过登录接口传给后端进行验证登录</li> <li>登录成功后返回token、用户信息、openid等信息</li> <li>把token缓存起来，调用接口传入进行鉴权</li> <li>没有token或者token过期则跳转到登录页重新登录</li> <li>结合权限设置进行其他判断处理</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// empower/index.js</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> miniLoginApi <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'../../api/login'</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    code<span class="token operator">:</span> <span class="token string">''</span> <span class="token comment">// 登录凭证</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  
<span class="token function-variable function">  onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> that <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token comment">// 获取登录凭证</span>
    wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token function">      success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> res
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span>
        that<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          code
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token parameter"> </span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          that<span class="token punctuation">.</span><span class="token function">getAuthSetting</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">/**
   * 获取用户的当前授权设置。
   * 返回值中只会出现小程序已经向用户请求过的权限。
   * */</span> 
<span class="token function">  getAuthSetting</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    wx<span class="token punctuation">.</span><span class="token function">getSetting</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token function">      success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> authSetting <span class="token punctuation">}</span> <span class="token operator">=</span> res
        <span class="token keyword">if</span><span class="token function"> </span><span class="token punctuation">(</span>authSetting<span class="token punctuation">[</span><span class="token string">'scope.userInfo'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 已经授权，可以直接调用 getUserInfo 获取头像昵称</span>
          wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token function-variable function">            success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
              console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
              <span class="token comment">// 获取加密算法和加密数据</span>
              <span class="token keyword">const</span> <span class="token punctuation">{</span> encryptedData<span class="token punctuation">,</span> iv <span class="token punctuation">}</span> <span class="token operator">=</span> res
              that<span class="token punctuation">.</span><span class="token function">userLogin</span><span class="token punctuation">(</span>encryptedData<span class="token punctuation">,</span> iv<span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
          
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 登录</span>
<span class="token function">  userLogin</span><span class="token punctuation">(</span><span class="token parameter">encryptedData<span class="token punctuation">,</span> iv</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> that <span class="token operator">=</span> <span class="token keyword">this</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> code <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data
    <span class="token keyword">const</span> params <span class="token operator">=</span> <span class="token punctuation">{</span>
      code<span class="token punctuation">,</span>
      encryptedData<span class="token punctuation">,</span>
      iv
    <span class="token punctuation">}</span>
<span class="token function">    miniLoginApi</span><span class="token punctuation">(</span>params<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token parameter"> </span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">.</span>code <span class="token operator">!==</span> <span class="token number">200</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            title<span class="token operator">:</span> res<span class="token punctuation">.</span>msg<span class="token punctuation">,</span>
            icon<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span>
            duration<span class="token operator">:</span> <span class="token number">2000</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token keyword">return</span>
        <span class="token punctuation">}</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
        <span class="token keyword">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> token <span class="token punctuation">}</span> <span class="token operator">=</span> res
        wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> token<span class="token punctuation">)</span>
        wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'userInfo'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>
        <span class="token comment">// 登录成功跳转到首页</span>
        wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          url<span class="token operator">:</span> <span class="token string">'/pages/index/index'</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token parameter"> </span><span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span>
        wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
          title<span class="token operator">:</span> err<span class="token punctuation">.</span>errMsg<span class="token punctuation">,</span>
          icon<span class="token operator">:</span> <span class="token string">'none'</span><span class="token punctuation">,</span>
          duration<span class="token operator">:</span> <span class="token number">2000</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_2、data数据修改"><a href="#_2、data数据修改" class="header-anchor">#</a> 2、data数据修改</h2> <p>通过[]中括号包裹起来，里面要改变的字段通过模板字符串拼接起来。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 对象修改</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">userBaseInfo.</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>field<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 数组修改</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">resourceList.[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>index<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">].value</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">]</span><span class="token operator">:</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 或者直接修改数据本身再赋值</span>
<span class="token keyword">const</span> resourceList <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>resourceList
resourceList<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>value <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">.</span>value
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  resourceList<span class="token operator">:</span> resourceList
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_3、函数绑定参数"><a href="#_3、函数绑定参数" class="header-anchor">#</a> 3、函数绑定参数</h2> <p>绑定事件参数数据通过data-=&quot;{{}}&quot; 来传，然后通过事件event来获取。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>view 
  <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;title-name&quot;</span> 
  wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;{{resourceList}}&quot;</span> 
  wx<span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;index&quot;</span> 
  data<span class="token operator">-</span>index<span class="token operator">=</span><span class="token string">&quot;{{index}}&quot;</span> 
  bindtap<span class="token operator">=</span><span class="token string">&quot;openSinSelect&quot;</span>
<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token function">openSinSelect</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> index <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>currentTarget<span class="token punctuation">.</span>dataset<span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_4、页面跳转"><a href="#_4、页面跳转" class="header-anchor">#</a> 4、页面跳转</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// tabbar跳转</span>
wx<span class="token punctuation">.</span><span class="token function">switchTab</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">'/pages/index/index'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 正常页面跳转</span>
wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/pages/my/index?id=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>id<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&amp;title=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>title<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_5、双层for循环渲染"><a href="#_5、双层for循环渲染" class="header-anchor">#</a> 5、双层for循环渲染</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;wrap-step&quot;</span> wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;{{flowList}}&quot;</span> wx<span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;index&quot;</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;step-user&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;user-item&quot;</span> wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;{{item.userList}}&quot;</span> wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">-</span>index<span class="token operator">=</span><span class="token string">&quot;idx&quot;</span> wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">-</span>item<span class="token operator">=</span><span class="token string">&quot;user&quot;</span> wx<span class="token operator">:</span>key<span class="token operator">=</span><span class="token string">&quot;idx&quot;</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>view <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;item-role&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>user<span class="token punctuation">.</span>name<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
</code></pre></div><h2 id="_6、globaldata对象的获取"><a href="#_6、globaldata对象的获取" class="header-anchor">#</a> 6、globalData对象的获取</h2> <p>在app.js中globalData对象中的值可以在全局所有页面中进行获取和设置，一些基础的数据或配置如请求地址等可以放在此处。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// app.js</span>
<span class="token comment">// 在app.js中调用方法要注意是否异步，如果是异步，其他页面无法保证调取后获取。</span>



<span class="token comment">// 其他方法</span>
<span class="token function">getUseInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>

globalData<span class="token operator">:</span> <span class="token punctuation">{</span>
  baseUrl<span class="token operator">:</span> <span class="token string">'http://xxxx.xx'</span>
<span class="token punctuation">}</span>
</code></pre></div><p>获取与调用方法</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> appInstance <span class="token operator">=</span><span class="token function"> getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> baseUrl <span class="token punctuation">}</span> <span class="token operator">=</span> appInstance<span class="token punctuation">.</span>globalData<span class="token punctuation">;</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token function-variable function">  onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>baseUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 调用app全局方法</span>
    appInstance<span class="token punctuation">.</span><span class="token function">getUseInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_7、动态设置标题"><a href="#_7、动态设置标题" class="header-anchor">#</a> 7、动态设置标题</h2> <p>默认标题可以在.json中的navigationBarTitleText设置。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code> wx<span class="token punctuation">.</span><span class="token function">setNavigationBarTitle</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  title<span class="token operator">:</span> <span class="token string">'首页'</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_8、页面周期函数与组件周期函数"><a href="#_8、页面周期函数与组件周期函数" class="header-anchor">#</a> 8、页面周期函数与组件周期函数</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//index.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    text<span class="token operator">:</span> <span class="token string">&quot;This is page data.&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">options</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do some initialize when page load.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onShow</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page show.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onReady</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page ready.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onHide</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page hide.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onUnload</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page close.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onPullDownRefresh</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when pull down.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onReachBottom</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page reach bottom.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onShareAppMessage</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// return custom share data when user share.</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onPageScroll</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page scroll</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">onResize</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Do something when page resize</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_9、下拉刷新与滑动加载更多"><a href="#_9、下拉刷新与滑动加载更多" class="header-anchor">#</a> 9、下拉刷新与滑动加载更多</h2> <p>上拉和下拉滑动我们可以借助容器组件 scroll-view</p> <blockquote><p>可滚动视图区域。使用竖向滚动时，需要给一个固定高度，通过wxss 设置。
我们把要滚动的内容放到scroll-view容器中，然后给这个容器设置高度，就可以在这个高度内进行监听上拉或下拉了。</p></blockquote> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>scroll-view</span> 
    <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>main-wrap<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name">scroll-y</span> 
    <span class="token attr-name">scroll-with-animation</span> 
    <span class="token attr-name">enable-back-to-top</span> 
    <span class="token attr-name">scroll-top</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{0}}<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name">refresher-enabled</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{true}}<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name">refresher-triggered</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{isFefresher}}<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name">bindscrolltolower</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pullUpLoadMore<span class="token punctuation">&quot;</span></span> 
    <span class="token attr-name">bindrefresherrefresh</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>pullDownRefresh<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>wrap-list<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{userList.length}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>list-item<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{userList}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item-detail<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>else</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-empty</span> <span class="token attr-name">description</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>暂无数据<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>scroll-view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>CSS设置</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.main</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token selector">;
  .main-wrap</span> <span class="token punctuation">{</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token selector">;
    .wrap-list</span> <span class="token punctuation">{</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>通过总数和已加载数判断是否加装完成。</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">const app = getApp()
const</span> <span class="token punctuation">{</span> interfaceUrl <span class="token punctuation">}</span> = app.globalData<span class="token selector">;

Page(</span><span class="token punctuation">{</span>
  <span class="token selector">data:</span> <span class="token punctuation">{</span>
    <span class="token selector">pagination:</span> <span class="token punctuation">{</span>
<span class="token property">      page</span><span class="token punctuation">:</span> 1<span class="token punctuation">,</span>
<span class="token property">      limit</span><span class="token punctuation">:</span> 20<span class="token punctuation">,</span>
<span class="token property">      total</span><span class="token punctuation">:</span> 0<span class="token punctuation">,</span>
<span class="token property">      flag</span><span class="token punctuation">:</span> false
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token property">    userList</span><span class="token punctuation">:</span> []<span class="token punctuation">,</span>
<span class="token property">    isFefresher</span><span class="token punctuation">:</span> false<span class="token punctuation">,</span> // 下拉刷新
  <span class="token punctuation">}</span><span class="token selector">,

  onLoad (option)</span> <span class="token punctuation">{</span>
    this.<span class="token function">getApprovalList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token selector">,



  // 获取列表
  getUserList()</span> <span class="token punctuation">{</span>
    const that = this<span class="token selector">;
    const</span> <span class="token punctuation">{</span> userList<span class="token punctuation">,</span> pagination <span class="token punctuation">}</span> = this.data<span class="token selector">;
    const</span> <span class="token punctuation">{</span> page<span class="token punctuation">,</span> limit <span class="token punctuation">}</span> = pagination<span class="token selector">;
    const params =</span> <span class="token punctuation">{</span>
      page<span class="token punctuation">,</span>
      limit
    <span class="token punctuation">}</span>
    <span class="token selector">wx.showLoading(</span><span class="token punctuation">{</span>
<span class="token property">      title</span><span class="token punctuation">:</span> <span class="token string">'加载中...'</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token selector">)
    wx.request(</span><span class="token punctuation">{</span>
      <span class="token selector">url: `$</span><span class="token punctuation">{</span>interfaceUrl<span class="token punctuation">}</span><span class="token selector">/api/xxx`,
      method: 'GET',
      data: params,
      header:</span> <span class="token punctuation">{</span>
        <span class="token string">'Authorization'</span><span class="token punctuation">:</span> wx.<span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token selector">,
      success(res)</span> <span class="token punctuation">{</span>
        wx.<span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token selector">;
        if (res.data.code != 200)</span> <span class="token punctuation">{</span>
          <span class="token selector">Dialog.alert(</span><span class="token punctuation">{</span>
<span class="token property">            title</span><span class="token punctuation">:</span> <span class="token string">'提示'</span><span class="token punctuation">,</span>
<span class="token property">            message</span><span class="token punctuation">:</span> res.data.msg
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
          return
        <span class="token punctuation">}</span>
        <span class="token selector">const</span> <span class="token punctuation">{</span> data<span class="token punctuation">,</span> total <span class="token punctuation">}</span> = res.data.data<span class="token selector">;
        that.setData(</span><span class="token punctuation">{</span>
<span class="token property">          isFefresher</span><span class="token punctuation">:</span> false<span class="token punctuation">,</span>
<span class="token property">          userList</span><span class="token punctuation">:</span> that.data.isFefresher ?<span class="token property"> data </span><span class="token punctuation">:</span> userList.<span class="token function">concat</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">,</span>
          [<span class="token string">'pagination.total'</span>]<span class="token punctuation">:</span> total
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token selector">,
      fail(err)</span> <span class="token punctuation">{</span>
        <span class="token selector">wx.hideLoading()
        Dialog.alert(</span><span class="token punctuation">{</span>
<span class="token property">          title</span><span class="token punctuation">:</span> <span class="token string">'错误'</span><span class="token punctuation">,</span>
<span class="token property">          message</span><span class="token punctuation">:</span> err.response.data.msg<span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token selector">,

  // 上划加载更多
  pullUpLoadMore()</span> <span class="token punctuation">{</span>
    <span class="token selector">let</span> <span class="token punctuation">{</span> flag<span class="token punctuation">,</span> page<span class="token punctuation">,</span> limit<span class="token punctuation">,</span> total <span class="token punctuation">}</span> = this.data.pagination<span class="token selector">;
    if (flag) return
    if (page &gt;= total / limit)</span> <span class="token punctuation">{</span>
      <span class="token selector">Notify(</span><span class="token punctuation">{</span><span class="token property"> type</span><span class="token punctuation">:</span> <span class="token string">'warning'</span><span class="token punctuation">,</span><span class="token property"> message</span><span class="token punctuation">:</span> <span class="token string">'已经全部加载'</span><span class="token punctuation">,</span><span class="token property"> duration</span><span class="token punctuation">:</span> 1000 <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token selector">;
      this.setData(</span><span class="token punctuation">{</span>
        [<span class="token string">'pagination.flag'</span>]<span class="token punctuation">:</span> true
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      return
    <span class="token punctuation">}</span>
    <span class="token selector">this.setData(</span><span class="token punctuation">{</span>
      [<span class="token string">'pagination.page'</span>]<span class="token punctuation">:</span> page += 1
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    this.<span class="token function">getUserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token selector">,

  // 下拉刷新
  pullDownRefresh(e)</span> <span class="token punctuation">{</span>
    <span class="token selector">this.setData(</span><span class="token punctuation">{</span>
      [<span class="token string">'pagination.page'</span>]<span class="token punctuation">:</span> 1<span class="token punctuation">,</span>
      [<span class="token string">'pagination.flag'</span>]<span class="token punctuation">:</span> false<span class="token punctuation">,</span>
<span class="token property">      isFefresher</span><span class="token punctuation">:</span> true
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    this.<span class="token function">getUserList</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>另一种方法，使用自带的周期函数。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token function">onPullDownRefresh</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

监听用户下拉刷新事件。
需要在app<span class="token punctuation">.</span>json的window选项中或页面配置中开启enablePullDownRefresh。
可以通过wx<span class="token punctuation">.</span>startPullDownRefresh触发下拉刷新，调用后触发下拉刷新动画，效果与用户手动下拉刷新一致。
当处理完数据刷新后，wx<span class="token punctuation">.</span>stopPullDownRefresh可以停止当前页面的下拉刷新。

<span class="token function">onReachBottom</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
监听用户上拉触底事件。
可以在app<span class="token punctuation">.</span>json的window选项中或页面配置中设置触发距离onReachBottomDistance。
在触发距离内滑动期间，本事件只会被触发一次。

<span class="token function">onPageScroll</span><span class="token punctuation">(</span><span class="token parameter">Object object</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
监听用户滑动页面事件。
</code></pre></div><h2 id="_10、获取当前页面路由信息"><a href="#_10、获取当前页面路由信息" class="header-anchor">#</a> 10、获取当前页面路由信息</h2> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> pages <span class="token operator">=</span><span class="token function"> getCurrentPages</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> currentPage <span class="token operator">=</span> pages<span class="token punctuation">[</span>pages<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token comment">// 当前页面路由</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>currentPage<span class="token punctuation">.</span>route<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// pages/index/index</span>
</code></pre></div><h2 id="_11、背景图片使用问题"><a href="#_11、背景图片使用问题" class="header-anchor">#</a> 11、背景图片使用问题</h2> <p>小程序使用CSS设置背景无法直接使用本地图片。只能使用base64图片地址，或者使用网络地址图片。</p> <p>解决方案：</p> <ul><li>使用image在布局下面覆盖一张图片。推荐使用</li> <li>将图片通过在线转化网站，转化成base64格式。</li> <li>直接使用网络图片。</li></ul> <h2 id="_12、获取微信授权信息"><a href="#_12、获取微信授权信息" class="header-anchor">#</a> 12、获取微信授权信息</h2> <p>获取微信授权，在获取之前要先判断用户有没有开启授权，没有开启，需要先跳转到授权权限设置页提示用户先把授权权限打开，然后再调用授权接口让用户同意授权，同意授权后再我们获取授权后的信息进行设置，没有就继续提示用户授权。</p> <p>目前基础信息授权模块已经不需要用户进行设置，默认开启，像获取地理位置、定位、摄像头等都需要用户先进行授权才能使用。</p> <p>获取授权我们调用接口就可以直接在用户打开页面之前自动提示要用户授权，不需要其他操作。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 获取用户的当前设置。返回值中只会出现小程序已经向用户请求过的权限。</span>
wx<span class="token punctuation">.</span><span class="token function">getSetting</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 调起客户端小程序设置界面，返回用户设置的操作结果。</span>
<span class="token comment">// 如果用户关闭授权权限，手动打开提示用户选择授权，然后再获取授权信息</span>
wx<span class="token punctuation">.</span><span class="token function">openSetting</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 获取精确地理位置，使用此方法需要在app.json进行设置才能使用</span>
<span class="token comment">// https://developers.weixin.qq.com/community/develop/doc/000a02f2c5026891650e7f40351c01</span>
wx<span class="token punctuation">.</span><span class="token function">getLocation</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 用户信息（小程序已回收，请使用头像昵称填写，小游戏可继续调用）</span>
wx<span class="token punctuation">.</span><span class="token function">getUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_13、公众号链接跳转到详情页"><a href="#_13、公众号链接跳转到详情页" class="header-anchor">#</a> 13、公众号链接跳转到详情页</h2> <p>小程序在管理后台配置好公众号后就可以在公众号发起消息，然后通过公众号跳转到小程序页面，这个发起消息和配置主要是后端进行配置，我们只需要告诉后端要跳转的地址页面和传的参数就行了，跳转和我们自己进行页面跳转一样，然后在周期函数中接收参数。</p> <p>跳转进来一定要先判断登录是否过期，要么在接口中统一判断，要么在当前页面接口判断。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// 给后端的跳转地址</span>
<span class="token string">'/pages/approvalDetail/index?approval_id=123'</span>

<span class="token comment">// 在页面中接收</span>
<span class="token function">onLoad</span><span class="token punctuation">(</span><span class="token parameter">option</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> approval_id <span class="token punctuation">}</span> <span class="token operator">=</span> option
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>approval_id<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><p>从不同地方跳转这也涉及到了小程序场景中的判断，微信提供了不同地方跳转进来的场景中，我们可以根据此值进行相应的操作。</p> <p><a href="https://developers.weixin.qq.com/miniprogram/dev/reference/scene-list.html" target="_blank" rel="noopener noreferrer">场景值-列表<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="_14、图片上传"><a href="#_14、图片上传" class="header-anchor">#</a> 14、图片上传</h2> <p>小程序上传文件通过 wx.uploadFile() 方法调用后端的上传接口进行上传，而不是直接使用 wx.request() 上传。</p> <p>我们借助vant 的上传组件进行上传图片。</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>van-uploader</span> 
  <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image<span class="token punctuation">&quot;</span></span> 
  <span class="token attr-name">file-list</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ remarkData.fileList }}<span class="token punctuation">&quot;</span></span> 
  <span class="token attr-name">preview-size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>60<span class="token punctuation">&quot;</span></span> 
  <span class="token attr-name">deletable</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{ true }}<span class="token punctuation">&quot;</span></span> 
  <span class="token attr-name"><span class="token namespace">bind:</span>after-read</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>changeTranImage<span class="token punctuation">&quot;</span></span> 
  <span class="token attr-name"><span class="token namespace">bind:</span>delete</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>deleteTranImage<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>van-uploader</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-javascript extra-class"><pre class="language-javascript"><code>data<span class="token operator">:</span> <span class="token punctuation">{</span>
  fileList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>



<span class="token comment">// 附件上传，获取文件内容</span>
<span class="token function">changeTranImage</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> file <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">;</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">uploadImages</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>

<span class="token comment">// 上传图片</span>
<span class="token function">uploadImages</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> url <span class="token punctuation">}</span> <span class="token operator">=</span> file<span class="token punctuation">;</span>
  <span class="token keyword">const</span> userInfo <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'user_info'</span><span class="token punctuation">)</span>
  
  <span class="token comment">// 签名验证，看接口是否需要，使用md5进行加密</span>
  <span class="token keyword">let</span> timestamp <span class="token operator">=</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> sign <span class="token operator">=</span><span class="token function"> hexMD5</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">secret=9njfyfnew1p&amp;timestamp=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>timestamp<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
 
  wx<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">'上传中...'</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  wx<span class="token punctuation">.</span><span class="token function">uploadFile</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>interfaceUrl<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">/api/v2/common/uploadFile</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> <span class="token comment">// 后端接口地址</span>
    header<span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token string">'Authorization'</span><span class="token operator">:</span> wx<span class="token punctuation">.</span><span class="token function">getStorageSync</span><span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    filePath<span class="token operator">:</span> url<span class="token punctuation">,</span> <span class="token comment">// 文件内容</span>
    name<span class="token operator">:</span> <span class="token string">'file'</span><span class="token punctuation">,</span> <span class="token comment">// 上传接口字段</span>
    formData<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token comment">// 其他参数</span>
      <span class="token string">'category'</span><span class="token operator">:</span> <span class="token string">'approval'</span><span class="token punctuation">,</span>
      <span class="token string">'source'</span><span class="token operator">:</span> <span class="token string">'miniprogram'</span><span class="token punctuation">,</span>
      <span class="token string">'store_id'</span><span class="token operator">:</span> userInfo<span class="token punctuation">.</span>store_id<span class="token punctuation">,</span>
      <span class="token string">'sign'</span><span class="token operator">:</span> sign<span class="token punctuation">,</span>
      <span class="token string">'timestamp'</span><span class="token operator">:</span> timestamp
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">    success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> data <span class="token operator">=</span> res<span class="token punctuation">.</span>data
      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> fileList <span class="token punctuation">}</span> <span class="token operator">=</span> that<span class="token punctuation">.</span>data
      fileList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
      <span class="token comment">// 添加到fileList自动回显，如果不显示可能是后端返回结构或自动不对</span>
      that<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        fileList
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">    fail</span><span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      Dialog<span class="token punctuation">.</span><span class="token function">alert</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'错误'</span><span class="token punctuation">,</span>
        message<span class="token operator">:</span> err<span class="token punctuation">.</span>response<span class="token punctuation">.</span>data<span class="token punctuation">.</span>msg
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token comment">// 删除图片</span>
<span class="token function">deleteTranImage</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> that <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> index <span class="token punctuation">}</span> <span class="token operator">=</span> e<span class="token punctuation">.</span>detail<span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> fileList <span class="token punctuation">}</span> <span class="token operator">=</span> that<span class="token punctuation">.</span>data
  fileList<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>index<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  that<span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    fileList
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_15、项目分包减少体积"><a href="#_15、项目分包减少体积" class="header-anchor">#</a> 15、项目分包减少体积</h2> <p>小程序所有文件默认体积大小就2M，如果整个包的内容超出就无法上传和发布，所以所有文件必须精简，图片尽量减少体积，插件也尽量少用。如果内容实在太多，则需要对代码进行分包，分成不同的模块进行加载就可以通过上传。分包后最好把相关的静态文件放到包的文件夹下，如果放在外层还是占主包的体积。</p> <p>我们默认的页面内容是放在pages文件下的，分包就是再创建一个和pages文件同级的文件，在里面创建页面就行了。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>├── pages                    # 页面目录
│   ├── index                # index页面
│   │   ├── index<span class="token punctuation">.</span>js         # 页面逻辑处理
│   │   ├── index<span class="token punctuation">.</span>json       # 页面配置
│   │   ├── index<span class="token punctuation">.</span>wxml       # html
│   │   ├── index<span class="token punctuation">.</span>wxss       # css
│   │   └── index<span class="token punctuation">.</span>less       # less<span class="token operator">/</span>sass
├── packageA                 # <span class="token constant">A</span>包
│   ├── assets               # <span class="token constant">A</span>包的静态资源
│   ├── components           # <span class="token constant">A</span>的业务公共组件
│   ├── my                   # my页面
│   │   ├── index<span class="token punctuation">.</span>js         
│   │   ├── index<span class="token punctuation">.</span>json       
│   │   ├── index<span class="token punctuation">.</span>wxml       
│   │   ├── index<span class="token punctuation">.</span>wxss       
│   │   └── index<span class="token punctuation">.</span>less       
├── packageB                 # <span class="token constant">B</span>包
│   ├── assets               # <span class="token constant">B</span>包的静态资源
│   ├── components           # <span class="token constant">B</span>的业务公共组件
│   ├── empower              # empower页面
│   │   ├── index<span class="token punctuation">.</span>js         
│   │   ├── index<span class="token punctuation">.</span>json       
│   │   ├── index<span class="token punctuation">.</span>wxml       
│   │   ├── index<span class="token punctuation">.</span>wxss  
│   │   └── index<span class="token punctuation">.</span>less 
</code></pre></div><p>页面包分好了，然后在app.json进行分包配置就可以了。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// app.json</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;pages/index/index&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;subpackages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>
    <span class="token string">&quot;root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packageA&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;A业务&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;pages/my/index&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
    <span class="token string">&quot;root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packageB&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;name&quot;</span><span class="token operator">:</span> <span class="token string">&quot;B业务&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token string">&quot;pages/empower/index&quot;</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;window&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>分包后页面地址也就跟着改变了，跳转时要带上包名才行。不同的包直接可以直接相互跳转。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/packageA/pages/my/index</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_16、版本更新提升"><a href="#_16、版本更新提升" class="header-anchor">#</a> 16、版本更新提升</h2> <p>每次更新小程序后我们可以在app.js进行设置提示用户版本更新。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//app.js</span>
<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
<span class="token function-variable function">  onLaunch</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token parameter">dataInfo</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//启动时更新</span>
    <span class="token keyword">const</span> updateManager <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getUpdateManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    updateManager<span class="token punctuation">.</span><span class="token function">onCheckForUpdate</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 请求完新版本信息的回调</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>hasUpdate<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    updateManager<span class="token punctuation">.</span><span class="token function">onUpdateReady</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        title<span class="token operator">:</span> <span class="token string">'更新提示'</span><span class="token punctuation">,</span>
        content<span class="token operator">:</span> <span class="token string">'新版本已经准备好了，请点击确定重启应用'</span><span class="token punctuation">,</span>
        showCancel<span class="token operator">:</span><span class="token boolean">false</span><span class="token punctuation">,</span>
<span class="token function">        success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token parameter">res<span class="token punctuation">.</span>confirm</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// 新的版本已经下载好，调用 applyUpdate 应用新版本并重启</span>
            updateManager<span class="token punctuation">.</span><span class="token function">applyUpdate</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    updateManager<span class="token punctuation">.</span><span class="token function">onUpdateFailed</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 新版本下载失败</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  globalData<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="_17、线上调试"><a href="#_17、线上调试" class="header-anchor">#</a> 17、线上调试</h2> <p>生产版本的小程序如果出现问题，可以调试一下正式版看看，调试方式如下：</p> <p>1、在项目中添加调试代码，把调试打开。这个设不设置好像都行。</p> <p><a href="https://developers.weixin.qq.com/miniprogram/dev/api/base/debug/wx.setEnableDebug.html" target="_blank" rel="noopener noreferrer">wx.setEnableDebug<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>2、先在开发版或体验版点击右上角三个点打开调试，再切到正式版就能看到vConsole</p> <h2 id="_18、自定义tabbar"><a href="#_18、自定义tabbar" class="header-anchor">#</a> 18、自定义tabbar</h2> <p>解决微信小程序自定义底部tabbar需要点击两次跳转问题： <a href="https://blog.csdn.net/qq_70046407/article/details/126206261" target="_blank" rel="noopener noreferrer">自定义tabbar出现的问题<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p><img src="/img/mini14.png" alt="图片"></p> <h2 id="_19、修改checkbox默认样式"><a href="#_19、修改checkbox默认样式" class="header-anchor">#</a> 19、修改checkbox默认样式</h2> <p>主要通过 .wx-checkbox-input 、.wx-checkbox-input-checked 以及 .wx-checkbox-input-checked::before 三个类名来设置 checkbox 的样式。</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code>checkbox <span class="token punctuation">.</span>wx<span class="token operator">-</span>checkbox<span class="token operator">-</span>input <span class="token punctuation">{</span>
  width<span class="token operator">:</span> <span class="token number">32</span>rpx<span class="token punctuation">;</span> 
  height<span class="token operator">:</span> <span class="token number">32</span>rpx<span class="token punctuation">;</span>
  border<span class="token operator">-</span>color<span class="token operator">:</span> #aaa<span class="token punctuation">;</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> transparent<span class="token punctuation">;</span>
  transition<span class="token operator">:</span> background<span class="token operator">-</span>color <span class="token number">.2</span>s<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
checkbox <span class="token punctuation">.</span>wx<span class="token operator">-</span>checkbox<span class="token operator">-</span>input<span class="token operator">-</span>checked <span class="token punctuation">{</span>
  color<span class="token operator">:</span> #fff<span class="token punctuation">;</span> <span class="token comment">/* 这里也可以设置对钩的颜色 */</span>
  background<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">409</span>eff<span class="token punctuation">;</span>
  border<span class="token operator">-</span>color<span class="token operator">:</span> #<span class="token number">409</span>eff<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="_20、自定义标题-获取顶部高度"><a href="#_20、自定义标题-获取顶部高度" class="header-anchor">#</a> 20、自定义标题&amp;获取顶部高度</h2> <p>自定义标题需要在当前页面.json里设置 &quot;navigationStyle&quot;: &quot;custom&quot; ，设置这个属性后默认的标题状态就没有了，页面顶到手机最顶部，我们自定义一个标题固定在页面最顶部就可以了。</p> <p>为了统一，我们需要先获取默认的标题栏安全高度。</p> <p>获取标题栏高度：需要计算状态栏高度和胶囊所占高度</p> <p><img src="/img/mini15.png" alt="图片"></p> <p>在app.js中进行获取标题栏高度</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//app.js</span>
<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  globalData<span class="token operator">:</span> <span class="token punctuation">{</span>
    statusBarHeight<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token comment">// 状态栏的高度</span>
    navHeight<span class="token operator">:</span> <span class="token number">0</span><span class="token comment">// 顶部高度</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function-variable function">  onLaunch</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token function"> </span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 获取标题栏高度</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getSystemTitlebarHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>

  <span class="token comment">// 获取标题栏高度</span>
<span class="token function">  getSystemTitlebarHeight</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> menuinformation <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getMenuButtonBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> statusBarHeight <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getSystemInfoSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string">'statusBarHeight'</span><span class="token punctuation">]</span> <span class="token comment">// 顶部状态栏高度</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> top<span class="token punctuation">,</span> height <span class="token punctuation">}</span> <span class="token operator">=</span> menuinformation
    <span class="token keyword">const</span> navHeight <span class="token operator">=</span><span class="token function"> </span><span class="token punctuation">(</span>top <span class="token operator">-</span> statusBarHeight<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">+</span> statusBarHeight <span class="token operator">+</span> height <span class="token comment">// 整个顶部的高 = (距顶部的高-状态栏高)*2 + 状态栏高 + 胶囊自身高</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>statusBarHeight <span class="token operator">=</span> statusBarHeight<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>globalData<span class="token punctuation">.</span>navHeight <span class="token operator">=</span> navHeight<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>js中引入</p> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> app <span class="token operator">=</span><span class="token function"> getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> <span class="token punctuation">{</span> statusBarHeight<span class="token punctuation">,</span> navHeight <span class="token punctuation">}</span> <span class="token operator">=</span> app<span class="token punctuation">.</span>globalData<span class="token punctuation">;</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    loading<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
    statusBarHeight<span class="token punctuation">,</span> <span class="token comment">// 导航栏高度</span>
    navHeight
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>自定义标题</p> <div class="language-xml extra-class"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index<span class="token punctuation">&quot;</span></span> <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>padding-top: {{navHeight - statusBarHeight}}px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 自定义标题 --&gt;</span>
  ​​<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>index-title<span class="token punctuation">&quot;</span></span> <span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>height: {{navHeight}}px; padding-top: {{statusBarHeight}}px<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>title-text<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>标题<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.index</span> <span class="token punctuation">{</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span> #F7F8FA<span class="token selector">;
  .index-title</span> <span class="token punctuation">{</span>
    <span class="token property">position</span><span class="token punctuation">:</span> fixed<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">z-index</span><span class="token punctuation">:</span> 999<span class="token punctuation">;</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token property">padding</span><span class="token punctuation">:</span> 0 30rpx<span class="token punctuation">;</span>
    <span class="token property">font-size</span><span class="token punctuation">:</span> 17px<span class="token punctuation">;</span>
    <span class="token property">color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> #fff<span class="token selector">;
    .title-text</span> <span class="token punctuation">{</span>
      <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
      <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
      <span class="token property">justify-content</span><span class="token punctuation">:</span> flex-start<span class="token punctuation">;</span>
      <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
      <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>21、wxs语法使用</p> <p>尺寸单位</p> <p>表单组件双向绑定</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/xingchen/mobile/applet/微信开发者工具使用插件.html" class="prev">
        微信开发者工具使用插件
      </a></span> <span class="next"><a href="/xingchen/mobile/applet/自定义组件.html">
        自定义组件
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/xingchen/assets/js/app.449d8865.js" defer></script><script src="/xingchen/assets/js/2.8855fdcf.js" defer></script><script src="/xingchen/assets/js/72.4abbeb3a.js" defer></script>
  </body>
</html>
